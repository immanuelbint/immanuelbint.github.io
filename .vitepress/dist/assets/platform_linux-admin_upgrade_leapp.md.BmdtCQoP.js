import{_ as a,c as s,o as i,ag as t}from"./chunks/framework.Bw-5EFTY.js";const k=JSON.parse('{"title":"Upgrading CentOS 7 to Rocky Linux 8","description":"Step-by-step guide to upgrade centos 7 to rocky 8 using leap-upgrade.","frontmatter":{"title":"Upgrading CentOS 7 to Rocky Linux 8","description":"Step-by-step guide to upgrade centos 7 to rocky 8 using leap-upgrade.","tags":["leap","centos","rocky linux","upgrade"]},"headers":[],"relativePath":"platform/linux-admin/upgrade/leapp.md","filePath":"platform/linux-admin/upgrade/leapp.md"}'),n={name:"platform/linux-admin/upgrade/leapp.md"};function p(l,e,o,r,h,d){return i(),s("div",null,e[0]||(e[0]=[t(`<h1 id="upgrading-centos-7-to-rocky-linux-8" tabindex="-1">Upgrading CentOS 7 to Rocky Linux 8 <a class="header-anchor" href="#upgrading-centos-7-to-rocky-linux-8" aria-label="Permalink to &quot;Upgrading CentOS 7 to Rocky Linux 8&quot;">​</a></h1><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>Welcome to our Storage How-to Guides—a curated set of clear, step-by-step tutorials designed to simplify storage and system management tasks in Linux environments. This guide walks you through upgrading a CentOS 7 system to Rocky Linux 8 using the <code>leapp</code> tool. Whether you’re modernizing your OS or preparing for new software requirements, this tutorial provides practical steps to ensure a smooth transition. No deep expertise is needed—just follow along for reliable results.</p><h2 id="environment" tabindex="-1">Environment <a class="header-anchor" href="#environment" aria-label="Permalink to &quot;Environment&quot;">​</a></h2><ul><li><strong>Operating System</strong>: CentOS 7.</li><li><strong>Target OS</strong>: Rocky Linux 8.</li><li><strong>Tools</strong>: <code>leapp</code>, <code>elevate-release</code>, <code>leapp-data-rocky</code>.</li></ul><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li><strong>Backup</strong>: Back up all critical data and configurations to prevent data loss.</li><li><strong>System Requirements</strong>: Ensure the system meets Rocky Linux 8 requirements (e.g., 2 GB RAM, 20 GB disk space).</li><li><strong>Internet Access</strong>: Required for downloading packages and repositories.</li><li><strong>Root Access</strong>: Run commands as <code>root</code> or with <code>sudo</code>.</li></ul><h2 id="steps" tabindex="-1">Steps <a class="header-anchor" href="#steps" aria-label="Permalink to &quot;Steps&quot;">​</a></h2><h3 id="step-1-update-centos-7-packages" tabindex="-1">Step 1 - Update CentOS 7 Packages <a class="header-anchor" href="#step-1-update-centos-7-packages" aria-label="Permalink to &quot;Step 1 - Update CentOS 7 Packages&quot;">​</a></h3><p>Before upgrading, ensure all CentOS 7 packages are up to date:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre></div><ul><li><code>-y</code>: Automatically confirms package updates.</li></ul><h3 id="step-2-reboot-the-system" tabindex="-1">Step 2 - Reboot the System <a class="header-anchor" href="#step-2-reboot-the-system" aria-label="Permalink to &quot;Step 2 - Reboot the System&quot;">​</a></h3><p>Reboot to apply any kernel or system updates:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span></span></code></pre></div><h3 id="step-3-update-packages-again" tabindex="-1">Step 3 - Update Packages Again <a class="header-anchor" href="#step-3-update-packages-again" aria-label="Permalink to &quot;Step 3 - Update Packages Again&quot;">​</a></h3><p>After rebooting, run another update to catch any remaining packages:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre></div><h3 id="step-4-reboot-again" tabindex="-1">Step 4 - Reboot Again <a class="header-anchor" href="#step-4-reboot-again" aria-label="Permalink to &quot;Step 4 - Reboot Again&quot;">​</a></h3><p>Perform a second reboot to ensure the system is fully updated:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span></span></code></pre></div><h3 id="step-5-verify-os-and-kernel-version" tabindex="-1">Step 5 - Verify OS and Kernel Version <a class="header-anchor" href="#step-5-verify-os-and-kernel-version" aria-label="Permalink to &quot;Step 5 - Verify OS and Kernel Version&quot;">​</a></h3><p>Check the current CentOS version and kernel:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/centos-release</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CentOS Linux release 7.9.2009 (Core)</span></span>
<span class="line"><span>3.10.0-1160.el7.x86_64</span></span></code></pre></div><ul><li>This confirms you’re running CentOS 7 with the latest updates.</li></ul><h3 id="step-6-install-the-elevate-repository" tabindex="-1">Step 6 - Install the Elevate Repository <a class="header-anchor" href="#step-6-install-the-elevate-repository" aria-label="Permalink to &quot;Step 6 - Install the Elevate Repository&quot;">​</a></h3><p>Install the <code>elevate-release</code> package to enable the repository for the upgrade:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://repo.almalinux.org/elevate/elevate-release-latest-el</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rpm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --eval</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %rhel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.noarch.rpm</span></span></code></pre></div><ul><li>This sets up the repository for Enterprise Linux 7 (EL7).</li></ul><h3 id="step-7-install-leapp-and-rocky-data-packages" tabindex="-1">Step 7 - Install Leapp and Rocky Data Packages <a class="header-anchor" href="#step-7-install-leapp-and-rocky-data-packages" aria-label="Permalink to &quot;Step 7 - Install Leapp and Rocky Data Packages&quot;">​</a></h3><p>Install the <code>leapp-upgrade</code> tool and the <code>leapp-data-rocky</code> package for Rocky Linux migration:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> leapp-upgrade</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> leapp-data-rocky</span></span></code></pre></div><h3 id="step-8-run-the-first-pre-upgrade-check" tabindex="-1">Step 8 - Run the First Pre-Upgrade Check <a class="header-anchor" href="#step-8-run-the-first-pre-upgrade-check" aria-label="Permalink to &quot;Step 8 - Run the First Pre-Upgrade Check&quot;">​</a></h3><p>Perform an initial pre-upgrade check to assess the system’s readiness:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> leapp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preupgrade</span></span></code></pre></div><ul><li>This analyzes packages, repositories, and system configuration for compatibility with Rocky Linux 8.</li><li>Check the generated report for issues: <ul><li><code>/var/log/leapp/leapp-report.txt</code>: Lists potential problems and remediation steps.</li><li><code>/var/log/leapp/answerfile</code>: Records pre-upgrade prompts and responses.</li></ul></li></ul><h3 id="step-9-configure-ssh-and-leapp-settings" tabindex="-1">Step 9 - Configure SSH and Leapp Settings <a class="header-anchor" href="#step-9-configure-ssh-and-leapp-settings" aria-label="Permalink to &quot;Step 9 - Configure SSH and Leapp Settings&quot;">​</a></h3><p>To address common issues during the upgrade:</p><ol><li>Enable root login in SSH (required by <code>leapp</code>):<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;PermitRootLogin yes&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/ssh/sshd_config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sshd</span></span></code></pre></div></li><li>Answer specific <code>leapp</code> checks to bypass known issues:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">leapp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> answer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --section</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> authselect_check.confirm=True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">leapp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> answer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --section</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove_pam_pkcs11_module_check.confirm=True</span></span></code></pre></div></li></ol><h3 id="step-10-run-the-second-pre-upgrade-check" tabindex="-1">Step 10 - Run the Second Pre-Upgrade Check <a class="header-anchor" href="#step-10-run-the-second-pre-upgrade-check" aria-label="Permalink to &quot;Step 10 - Run the Second Pre-Upgrade Check&quot;">​</a></h3><p>Repeat the pre-upgrade check to ensure all issues are resolved:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> leapp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preupgrade</span></span></code></pre></div><ul><li>Review <code>/var/log/leapp/leapp-report.txt</code> again for any remaining issues.</li><li>Follow remediation steps if errors are reported (e.g., removing conflicting packages).</li></ul><p><strong>Note</strong>: Thoroughly inspect <code>/var/log/leapp/leapp-report.txt</code> and <code>/var/log/leapp/answerfile</code> to understand and resolve any issues before proceeding.</p><h3 id="step-11-perform-the-upgrade" tabindex="-1">Step 11 - Perform the Upgrade <a class="header-anchor" href="#step-11-perform-the-upgrade" aria-label="Permalink to &quot;Step 11 - Perform the Upgrade&quot;">​</a></h3><p>Initiate the OS upgrade to Rocky Linux 8:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> leapp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span></span></code></pre></div><ul><li>This prepares the system for the upgrade, creating a special boot entry.</li></ul><h3 id="step-12-reboot-to-complete-the-upgrade" tabindex="-1">Step 12 - Reboot to Complete the Upgrade <a class="header-anchor" href="#step-12-reboot-to-complete-the-upgrade" aria-label="Permalink to &quot;Step 12 - Reboot to Complete the Upgrade&quot;">​</a></h3><p>Reboot the system to start the upgrade process:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span></span></code></pre></div><ul><li>During reboot, the system will use a temporary kernel to perform the upgrade from CentOS 7 to Rocky Linux 8.</li><li>The VM may be temporarily inaccessible during this process as the upgrade modifies core system components.</li></ul><h3 id="step-13-verify-the-upgrade" tabindex="-1">Step 13 - Verify the Upgrade <a class="header-anchor" href="#step-13-verify-the-upgrade" aria-label="Permalink to &quot;Step 13 - Verify the Upgrade&quot;">​</a></h3><p>After the reboot, confirm the new OS version:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/rocky-release</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Rocky Linux release 8.10 (Green Obsidian)</span></span>
<span class="line"><span>4.18.0-553.el8.x86_64</span></span></code></pre></div><ul><li>This confirms the system is now running Rocky Linux 8 with an updated kernel.</li></ul><h2 id="notes" tabindex="-1">Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;Notes&quot;">​</a></h2><ul><li><strong>Check Logs</strong>: If issues arise, review <code>/var/log/leapp/leapp-report.txt</code> for detailed remediation steps.</li><li><strong>Firewall and SELinux</strong>: Adjust settings post-upgrade if needed for your environment.</li><li><strong>Post-Upgrade</strong>: Run <code>sudo dnf update -y</code> to ensure all Rocky Linux packages are current.</li><li><strong>Backup</strong>: Always have a full backup before upgrading, as the process is complex and risks data loss.</li></ul><h2 id="related-scripts" tabindex="-1">Related Scripts <a class="header-anchor" href="#related-scripts" aria-label="Permalink to &quot;Related Scripts&quot;">​</a></h2><ul><li>Content under construction</li></ul>`,64)]))}const u=a(n,[["render",p]]);export{k as __pageData,u as default};
