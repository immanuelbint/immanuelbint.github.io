import{_ as e,c as a,o as i,ag as t}from"./chunks/framework.Bw-5EFTY.js";const u=JSON.parse('{"title":"Resize LVM Disk","description":"Step-by-step guide to resize LVM Disk","frontmatter":{"title":"Resize LVM Disk","description":"Step-by-step guide to resize LVM Disk","tags":["lvm","storage","linux","resize"]},"headers":[],"relativePath":"platform/storage/lvm/resize-lvm.md","filePath":"platform/storage/lvm/resize-lvm.md"}'),n={name:"platform/storage/lvm/resize-lvm.md"};function l(p,s,o,d,h,r){return i(),a("div",null,s[0]||(s[0]=[t(`<h1 id="resizing-an-lvm-disk-for-the-root-mountpoint" tabindex="-1">Resizing an LVM Disk for the Root Mountpoint <a class="header-anchor" href="#resizing-an-lvm-disk-for-the-root-mountpoint" aria-label="Permalink to &quot;Resizing an LVM Disk for the Root Mountpoint&quot;">​</a></h1><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>Logical Volume Manager (LVM) provides flexible disk management, allowing you to resize storage without downtime. This guide explains how to resize the LVM disk for the root (<code>/</code>) mountpoint on a Linux system, typically used with KVM virtual machines. We’ll add a new disk, extend the volume group, and resize the logical volume to increase the root filesystem’s capacity.</p><h2 id="environment" tabindex="-1">Environment <a class="header-anchor" href="#environment" aria-label="Permalink to &quot;Environment&quot;">​</a></h2><ul><li><strong>Operating System</strong>: Linux (e.g., CentOS, Rocky Linux, Ubuntu).</li><li><strong>Virtualization</strong>: KVM (optional, for adding disks to VMs).</li><li><strong>Disk Type</strong>: LVM (Logical Volume Manager).</li><li><strong>Mountpoint</strong>: Root (<code>/</code>).</li></ul><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><p>Before resizing, verify the current disk configuration, mountpoints, and LVM details using:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsblk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>NAME                        MAJ:MIN RM    SIZE RO TYPE MOUNTPOINT</span></span>
<span class="line"><span>/dev/sr0                     11:0    1   1024M  0 rom</span></span>
<span class="line"><span>/dev/vda                    252:0    0    200G  0 disk</span></span>
<span class="line"><span>├─/dev/vda1                 252:1    0    200M  0 part /boot/efi</span></span>
<span class="line"><span>├─/dev/vda2                 252:2    0      1G  0 part /boot</span></span>
<span class="line"><span>└─/dev/vda3                 252:3    0  198.8G  0 part</span></span>
<span class="line"><span>  ├─/dev/mapper/centos-root 253:0    0   88.8G  0 lvm  /</span></span>
<span class="line"><span>  └─/dev/mapper/centos-swap 253:1    0     10G  0 lvm  [SWAP]</span></span>
<span class="line"><span>/dev/vdb                    252:16   0  500.1G  0 disk</span></span>
<span class="line"><span>├─/dev/vdb1                 252:17   0  186.3G  0 part /home</span></span>
<span class="line"><span>└─/dev/vdb2                 252:18   0  313.8G  0 part /log</span></span>
<span class="line"><span>/dev/vdc                    252:32   0 1000.2G  0 disk</span></span>
<span class="line"><span>└─/dev/vdc1                 252:33   0 1000.2G  0 part /data</span></span></code></pre></div><ul><li><strong>Key Information</strong>: <ul><li>Mountpoint: <code>/</code> (root).</li><li>LVM Path: <code>/dev/mapper/centos-root</code>.</li><li>Volume Group: Likely <code>centos</code> (to be confirmed).</li><li>Disk: New disk will be added (e.g., <code>/dev/vdd</code>).</li></ul></li></ul><p><strong>Note</strong>: Always back up critical data before modifying disks to prevent data loss.</p><h2 id="steps" tabindex="-1">Steps <a class="header-anchor" href="#steps" aria-label="Permalink to &quot;Steps&quot;">​</a></h2><h3 id="step-1-add-a-new-disk" tabindex="-1">Step 1 - Add a New Disk <a class="header-anchor" href="#step-1-add-a-new-disk" aria-label="Permalink to &quot;Step 1 - Add a New Disk&quot;">​</a></h3><p>For LVM resizing, adding a new disk is recommended to provide additional space. If using KVM:</p><ul><li>Access the VM’s management interface (e.g., <code>virt-manager</code> or <code>virsh</code>).</li><li>Add a new virtual disk with the desired size (e.g., 100 GB) to the VM.</li><li>Ensure the VM recognizes the new disk after rebooting or hot-adding.</li></ul><p><strong>Note</strong>: Choose a disk size that meets your capacity needs.</p><h3 id="step-2-verify-the-new-disk" tabindex="-1">Step 2 - Verify the New Disk <a class="header-anchor" href="#step-2-verify-the-new-disk" aria-label="Permalink to &quot;Step 2 - Verify the New Disk&quot;">​</a></h3><p>Check the new disk’s path using:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsblk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></div><ul><li>Example: If the new disk appears as <code>/dev/vdd</code>, note its path.</li><li>If the disk isn’t visible, rescan the bus:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;- - -&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/class/scsi_host/hostX/scan</span></span></code></pre></div>(Replace <code>hostX</code> with the appropriate SCSI host, e.g., <code>host0</code>.)</li></ul><h3 id="step-3-create-a-physical-volume" tabindex="-1">Step 3 - Create a Physical Volume <a class="header-anchor" href="#step-3-create-a-physical-volume" aria-label="Permalink to &quot;Step 3 - Create a Physical Volume&quot;">​</a></h3><p>Initialize the new disk as a physical volume (PV) for LVM:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pvcreate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">new-disk-pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><ul><li>Example: <code>sudo pvcreate /dev/vdd</code></li><li>This prepares the disk for use in an LVM volume group.</li></ul><h3 id="step-4-identify-the-volume-group" tabindex="-1">Step 4 - Identify the Volume Group <a class="header-anchor" href="#step-4-identify-the-volume-group" aria-label="Permalink to &quot;Step 4 - Identify the Volume Group&quot;">​</a></h3><p>List the existing volume groups to find the one associated with the root filesystem:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vgs</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  VG     #PV #LV #SN Attr   VSize   VFree</span></span>
<span class="line"><span>  centos   1   2   0 wz--n- 198.80g 100.00g</span></span></code></pre></div><ul><li>The volume group (VG) name is <code>centos</code> (from <code>/dev/mapper/centos-root</code>).</li></ul><h3 id="step-5-extend-the-volume-group" tabindex="-1">Step 5 - Extend the Volume Group <a class="header-anchor" href="#step-5-extend-the-volume-group" aria-label="Permalink to &quot;Step 5 - Extend the Volume Group&quot;">​</a></h3><p>Add the new physical volume to the existing volume group:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vgextend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">volume-group-nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">new-disk-pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><ul><li>Example: <code>sudo vgextend centos /dev/vdd</code></li><li>This increases the VG’s capacity by incorporating the new disk.</li></ul><h3 id="step-6-verify-volume-group-changes" tabindex="-1">Step 6 - Verify Volume Group Changes <a class="header-anchor" href="#step-6-verify-volume-group-changes" aria-label="Permalink to &quot;Step 6 - Verify Volume Group Changes&quot;">​</a></h3><p>Check the volume group to confirm the new physical volume was added:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vgs</span></span></code></pre></div><p>Or, for more details:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vgdisplay</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  --- Volume group ---</span></span>
<span class="line"><span>  VG Name               centos</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  VG Size               298.80 GiB</span></span>
<span class="line"><span>  PE Size               4.00 MiB</span></span>
<span class="line"><span>  Total PE              76544</span></span>
<span class="line"><span>  Free  PE              25600</span></span>
<span class="line"><span>  Alloc PE / Size       50944 / 198.80 GiB</span></span>
<span class="line"><span>  PV Count              2</span></span></code></pre></div><ul><li><code>PV Count: 2</code> confirms the new disk was added.</li></ul><h3 id="step-7-identify-the-logical-volume" tabindex="-1">Step 7 - Identify the Logical Volume <a class="header-anchor" href="#step-7-identify-the-logical-volume" aria-label="Permalink to &quot;Step 7 - Identify the Logical Volume&quot;">​</a></h3><p>List logical volumes to find the one for the root mountpoint:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lvs</span></span></code></pre></div><p>Or, for details:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lvdisplay</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  --- Logical volume ---</span></span>
<span class="line"><span>  LV Path                /dev/centos/root</span></span>
<span class="line"><span>  LV Name                root</span></span>
<span class="line"><span>  VG Name                centos</span></span>
<span class="line"><span>  LV Size                88.80 GiB</span></span></code></pre></div><ul><li>The logical volume (LV) path is <code>/dev/centos/root</code>.</li></ul><h3 id="step-8-extend-the-logical-volume" tabindex="-1">Step 8 - Extend the Logical Volume <a class="header-anchor" href="#step-8-extend-the-logical-volume" aria-label="Permalink to &quot;Step 8 - Extend the Logical Volume&quot;">​</a></h3><p>Extend the logical volume to use all available space in the volume group:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lvextend</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +100%FREE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">logical-volume-pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><ul><li>Example: <code>sudo lvextend -l +100%FREE /dev/centos/root</code></li><li><code>-l +100%FREE</code>: Allocates all free space in the VG to the LV.</li></ul><h3 id="step-9-resize-the-filesystem" tabindex="-1">Step 9 - Resize the Filesystem <a class="header-anchor" href="#step-9-resize-the-filesystem" aria-label="Permalink to &quot;Step 9 - Resize the Filesystem&quot;">​</a></h3><p>Update the filesystem to recognize the new LV size. For XFS (common on CentOS/RHEL):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xfs_growfs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mountpoin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><ul><li>Example: <code>sudo xfs_growfs /</code></li><li>If using ext4, use:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resize2fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">logical-volume-pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><ul><li>Example: <code>sudo resize2fs /dev/centos/root</code></li></ul></li></ul><p>This step adjusts the filesystem to use the expanded space.</p><h3 id="step-10-verify-the-new-size" tabindex="-1">Step 10 - Verify the New Size <a class="header-anchor" href="#step-10-verify-the-new-size" aria-label="Permalink to &quot;Step 10 - Verify the New Size&quot;">​</a></h3><p>Confirm the resized disk size:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">df</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -kh</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Filesystem                 Size  Used Avail Use% Mounted on</span></span>
<span class="line"><span>/dev/mapper/centos-root    188G  5.0G  183G   3% /</span></span></code></pre></div><p>Or:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsblk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></div><p>Example output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>NAME                        MAJ:MIN RM    SIZE RO TYPE MOUNTPOINT</span></span>
<span class="line"><span>/dev/vda                    252:0    0    200G  0 disk</span></span>
<span class="line"><span>├─/dev/vda1                 252:1    0    200M  0 part /boot/efi</span></span>
<span class="line"><span>├─/dev/vda2                 252:2    0      1G  0 part /boot</span></span>
<span class="line"><span>└─/dev/vda3                 252:3    0  198.8G  0 part</span></span>
<span class="line"><span>  ├─/dev/mapper/centos-root 253:0    0   188.8G  0 lvm  /</span></span>
<span class="line"><span>  └─/dev/mapper/centos-swap 253:1    0     10G  0 lvm  [SWAP]</span></span>
<span class="line"><span>/dev/vdd                    252:48   0    100G  0 disk</span></span></code></pre></div><ul><li>The root filesystem (<code>/dev/mapper/centos-root</code>) now reflects the increased size.</li></ul><h2 id="notes" tabindex="-1">Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;Notes&quot;">​</a></h2><ul><li><strong>Backup First</strong>: Always back up data before resizing to avoid loss.</li><li><strong>Filesystem Type</strong>: Confirm the filesystem type (<code>xfs</code> or <code>ext4</code>) with <code>df -T</code>. Use the appropriate resize command.</li><li><strong>KVM Disk Addition</strong>: If not using KVM, add a physical disk to a bare-metal server and rescan as needed.</li><li><strong>Error Handling</strong>: If <code>pvcreate</code> fails, ensure the disk is not partitioned (<code>fdisk</code> to remove partitions if needed).</li></ul><h2 id="related-scripts" tabindex="-1">Related Scripts <a class="header-anchor" href="#related-scripts" aria-label="Permalink to &quot;Related Scripts&quot;">​</a></h2><ul><li>Content under construction</li></ul>`,74)]))}const k=e(n,[["render",l]]);export{u as __pageData,k as default};
